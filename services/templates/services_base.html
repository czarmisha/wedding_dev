{% load i18n %}
{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>{% block title %}{% endblock %}</title>
    {% block links %}{% endblock %}
</head>
<body>
<div id="header">
    <span class="logo">Bookmarks</span>
</div>
<div id="content">
    <a href="{% url 'home' %}">home</a>
    {% block content %}
    {% endblock %}
    <div class="pagination">
    <span class="step-links">
        {% if page_obj.has_previous %}
            <a href="?page=1">&laquo; first</a>
            <a href="?page={{ page_obj.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
        </span>

        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}">next</a>
            <a href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
        {% endif %}
    </span>
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
{%block script%}
<script>
    $(document).ready(function() {
      $('.form_confirm').click(function(e) {
        e.preventDefault();
        let form = $('.review_form');
        let textarea = $('.review_form textarea')
        var btn = $(this);
        if(textarea.val() != '' && textarea.val() != ' '){
          $.ajax({
          method: "POST",
          url: "{% url 'services:create_review' %}",
          dataType: "json",
          data: {
              'csrfmiddlewaretoken': "{{ csrf_token }}",
              "service_user_pk": '{{object.user.pk}}',
              "client_user_pk": '{{request.user.pk}}',
              "text": textarea.val()
          },
          success: function(data) {
            if(data['success'] && data['save'])window.location.reload()
            console.log(data)
          },
          error: function(er) {
            console.log(er);
          }
        });
        }
        else alert('Напишите текст отзыва перед отправкой')
      })
    });
</script>
<script type="text/javascript" src="{% static 'star-ratings/js/dist/star-ratings.min.js' %}"></script>
{%endblock%}

</body>
</html>